
{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's profile information.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User Profile."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "displayName": {
          "type": "string",
          "description": "The user's display name."
        },
        "photoURL": {
          "type": "string",
          "format": "uri",
          "description": "URL of the user's profile image."
        }
      },
      "required": ["id", "email"]
    },
    "RealEstateAgentProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "RealEstateAgentProfile",
      "type": "object",
      "description": "Represents the profile of a real estate agent, containing their professional details and reputation data.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Real Estate Agent Profile."
        },
        "name": {
          "type": "string",
          "description": "The agent's full name."
        },
        "photoURL": {
          "type": "string",
          "format": "uri",
          "description": "URL of the agent's profile image."
        },
        "licenses": {
          "type": "array",
          "description": "An array of the agent's licenses.",
          "items": {
            "type": "string"
          }
        },
        "certifications": {
          "type": "array",
          "description": "An array of the agent's certifications (e.g., CRS, ABR).",
          "items": {
            "type": "string"
          }
        },
        "yearsOfExperience": {
          "type": "number",
          "description": "The number of years of experience the agent has."
        },
        "transactionHistory": {
          "type": "number",
          "description": "The number of past transactions completed by the agent."
        },
        "bio": {
          "type": "string",
          "description": "A detailed biography of the agent."
        },
        "zillowEmail": {
          "type": "string",
          "format": "email",
          "description": "The email address associated with the agent's Zillow Premier Agent profile."
        }
      },
      "required": [
        "id",
        "name",
        "bio"
      ]
    },
    "Review": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Review",
      "type": "object",
      "description": "Represents a review from any platform.",
      "properties": {
        "id": { "type": "string" },
        "agentId": { "type": "string" },
        "author": { 
          "type": "object",
          "properties": { "name": { "type": "string" } },
          "required": ["name"]
        },
        "source": { "type": "string", "enum": ["Google", "Zillow", "Yelp"] },
        "avatarUrl": { "type": "string", "format": "uri" },
        "rating": { "type": "number", "minimum": 1, "maximum": 5 },
        "comment": { "type": "string" },
        "date": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "agentId", "author", "source", "rating", "comment", "date"]
    },
    "BrandAudit": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "BrandAudit",
      "type": "object",
      "description": "Stores the results of a NAP consistency audit.",
      "properties": {
        "id": { "type": "string" },
        "results": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "platform": { "type": "string" },
              "platformUrl": { "type": "string", "format": "uri" },
              "foundName": { "type": "string" },
              "foundAddress": { "type": "string" },
              "foundPhone": { "type": "string" },
              "status": { "type": "string", "enum": ["Consistent", "Inconsistent", "Not Found"] }
            },
            "required": ["platform", "status"]
          }
        },
        "lastRun": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "results", "lastRun"]
    },
    "Competitor": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Competitor",
      "type": "object",
      "description": "Represents a competitor real estate agent.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "agency": { "type": "string" },
        "reviewCount": { "type": "number" },
        "avgRating": { "type": "number" },
        "socialFollowers": { "type": "number" },
        "domainAuthority": { "type": "number" }
      },
      "required": ["id", "name", "agency", "reviewCount", "avgRating", "socialFollowers", "domainAuthority"]
    },
     "ResearchReport": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ResearchReport",
      "type": "object",
      "description": "Represents a saved AI research report.",
      "properties": {
        "id": { "type": "string" },
        "topic": { "type": "string" },
        "report": { "type": "string" },
        "citations": { "type": "array", "items": { "type": "string", "format": "uri" } },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "topic", "report", "createdAt"]
    },
    "Project": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Project",
      "type": "object",
      "description": "Represents a project folder for organizing content.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "name", "createdAt"]
    },
    "SavedContent": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SavedContent",
      "type": "object",
      "description": "Represents a piece of saved AI-generated content.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string", "description": "A user-defined name for the content." },
        "type": { "type": "string", "description": "The type or source of the content (e.g., 'Blog Post', 'Market Update')." },
        "content": { "type": "string" },
        "projectId": { "type": "string", "description": "The ID of the project folder this content belongs to." },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "type", "content", "createdAt"]
    },
    "TrainingProgress": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TrainingProgress",
      "type": "object",
      "description": "Tracks a user's completion status for a training module.",
      "properties": {
        "id": {
          "type": "string"
        },
        "completed": {
          "type": "boolean"
        },
        "completedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "completed",
        "completedAt"
      ]
    },
    "MarketingPlan": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "MarketingPlan",
        "type": "object",
        "description": "Represents an AI-generated marketing plan for a real estate agent.",
        "properties": {
            "id": { "type": "string" },
            "plan": {
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "task": { "type": "string" },
                        "rationale": { "type": "string" },
                        "toolLink": { "type": "string", "format": "uri-reference" },
                        "tool": { "type": "string" }
                    },
                    "required": ["task", "rationale", "toolLink", "tool"]
                }
            },
            "createdAt": { "type": "string", "format": "date-time" }
        },
        "required": ["id", "plan", "createdAt"]
    },
    "ReviewAnalysis": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "ReviewAnalysis",
        "type": "object",
        "description": "Stores the results of a bulk review analysis.",
        "properties": {
            "id": { "type": "string" },
            "overallSentiment": { "type": "string", "enum": ["Positive", "Negative", "Mixed"] },
            "summary": { "type": "string" },
            "keywords": { "type": "array", "items": { "type": "string" } },
            "commonThemes": { "type": "array", "items": { "type": "string" } },
            "analyzedAt": { "type": "string", "format": "date-time" }
        },
        "required": ["id", "overallSentiment", "summary", "keywords", "commonThemes", "analyzedAt"]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/UserProfile"
      },
      "description": "Stores basic user profile information, populated on first login."
    },
    "/users/{userId}/agentProfiles/{agentProfileId}": {
      "schema": {
        "$ref": "#/entities/RealEstateAgentProfile"
      },
      "description": "Stores the detailed professional profile for a real estate agent. There is typically one document per user with a fixed ID like 'main'."
    },
    "/reviews": {
      "schema": {
        "$ref": "#/entities/Review"
      },
      "description": "A root collection of all reviews from all platforms. Security rules will ensure users can only read reviews where review.agentId matches their own profile ID."
    },
    "/users/{userId}/brandAudits/{auditId}": {
      "schema": {
        "$ref": "#/entities/BrandAudit"
      },
      "description": "Stores the results of NAP consistency audits for a user."
    },
    "/users/{userId}/reviewAnalyses/{analysisId}": {
      "schema": {
        "$ref": "#/entities/ReviewAnalysis"
      },
      "description": "Stores the results of bulk review analyses for a user. There is typically one document per user with a fixed ID like 'main'."
    },
    "/users/{userId}/competitors/{competitorId}": {
      "schema": {
        "$ref": "#/entities/Competitor"
      },
      "description": "Stores the list of competitors a user is tracking."
    },
    "/users/{userId}/researchReports/{reportId}": {
      "schema": {
        "$ref": "#/entities/ResearchReport"
      },
      "description": "Stores saved research reports generated by the AI agent."
    },
     "/users/{userId}/projects/{projectId}": {
      "schema": {
        "$ref": "#/entities/Project"
      },
      "description": "A collection of user-created project folders for organizing content."
    },
    "/users/{userId}/savedContent/{contentId}": {
      "schema": {
        "$ref": "#/entities/SavedContent"
      },
      "description": "A collection of miscellaneous AI-generated content saved by the user."
    },
     "/users/{userId}/trainingProgress/{moduleId}": {
      "schema": {
        "$ref": "#/entities/TrainingProgress"
      },
      "description": "Stores the user's progress for each training module."
    },
    "/users/{userId}/marketingPlans/{planId}": {
        "schema": {
            "$ref": "#/entities/MarketingPlan"
        },
        "description": "Stores AI-generated marketing plans for the user."
    },
    "/googleBusinessProfiles/{userId}": {
      "schema": {
        "type": "object",
        "properties": {
          "accessToken": {
            "type": "string"
          },
          "refreshToken": {
            "type": "string"
          },
          "expiryDate": {
            "type": "number"
          }
        }
      },
      "description": "Stores OAuth tokens for Google Business Profile integration, with the document ID matching the user's ID."
    }
  },
  "storage": {
    "structure": [
      {
        "path": "/users/{userId}/profile.jpg",
        "description": "Stores the user's profile picture. Each user can have one image named 'profile.jpg'.",
        "rules": {
          "read": "allow read: if true;",
          "write": "allow write: if request.auth != null && request.auth.uid == userId;"
        }
      }
    ]
  }
}
