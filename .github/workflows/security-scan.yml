name: Security Scan

on:
    push:
        branches: [main, develop]
    pull_request:
        branches: [main, develop]
    schedule:
        # Run weekly on Mondays at 9am UTC
        - cron: "0 9 * * 1"

jobs:

    dependency-scan:
        name: Scan dependencies
        runs-on: ubuntu-latest

        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Run npm audit
              run: npm audit --audit-level=moderate
              continue-on-error: true

            - name: Run Snyk security scan
              uses: snyk/actions/node@master
              continue-on-error: true
              env:
                  SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
              with:
                  args: --severity-threshold=high
